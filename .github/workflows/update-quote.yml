name: Update Daily Quote 📜

on:
  schedule:
    # Har minute run hoga testing ke liye
    - cron: '* * * * *'
  workflow_dispatch:

jobs:
  update_readme:
    name: Update README with a new quote
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository 🛎️
        uses: actions/checkout@v4

      - name: Setup Python 🐍
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies 📦
        run: pip install requests

      - name: Fetch Quote & Update README ✍️
        run: |
          import requests
          import re

          # API se quote fetch karein
          response = requests.get("https://tsunquotes.tsunstudio.pw/api/quotes")
          data = response.json()
          quote = data.get("quote")
          author = data.get("author")
          
          # Naya quote format karein
          new_quote_text = f'"{quote}"<br><br>— *{author}*'

          # README file read karein
          with open("README.md", "r", encoding="utf-8") as file:
              content = file.read()

          # Comments ke beech ka content replace karein
          start_marker = ""
          end_marker = ""
          
          # Regular expression ka use karke replace karein
          updated_content = re.sub(f"({re.escape(start_marker)})(.*?)({re.escape(end_marker)})", f"\\1\n{new_quote_text}\n\\3", content, flags=re.DOTALL)

          # README file mein wapis write karein
          with open("README.md", "w", encoding="utf-8") as file:
              file.write(updated_content)
        shell: python

      - name: Commit and Push Changes 🚀
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "✨ Update daily quote"
          branch: main
          file_pattern: README.md
          commit_user_name: GitHub Actions Bot
          commit_user_email: actions@github.com
          commit_author: GitHub Actions Bot <actions@github.com>
